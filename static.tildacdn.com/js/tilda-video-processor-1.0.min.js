function setWidthHeightHTMLVideo(video,height){console.log("setWidthHeightHTMLVideo:"+height);var el=video.closest(".t-cover__carrier");height+="";var iframe=el.find("video"),nocover=el.attr("data-content-video-nocover"),customratio=el.attr("data-content-video-ratio"),video_ratio=.5625;if(customratio>0&&(video_ratio=1*parseFloat(customratio)),"yes"!=nocover){if(height||(height="100vh"),height.indexOf("vh")>-1){var wh=window.innerHeight;wh||(wh=$(window).height());var div_height=Math.floor(wh*(parseInt(height)/100))}else var div_height=parseInt(height);var div_width=Math.floor(parseInt(window.innerWidth));div_width||(div_width=$(window).width());var video_width=div_width,video_height,vw2=div_width,vh2=video_height=div_width*video_ratio,vh3,delta_coef=1;if(video_height<div_height)if(video_height<div_height)var delta_coef=div_height/video_height+.02;else var delta_coef=video_height/div_height+.02;var zoom_video_width=Math.floor(vw2*delta_coef),zoom_video_height=Math.floor(vh2*delta_coef),heightDelta=zoom_video_height-div_height,widthDelta=zoom_video_width-div_width;iframe.height(zoom_video_height+"px"),iframe.width(zoom_video_width+"px"),video.height(zoom_video_height+"px"),video.width(zoom_video_width+"px"),heightDelta>0&&(iframe.css("margin-top",-Math.floor(heightDelta/2)+"px"),video.css("margin-top",-Math.floor(heightDelta/2)+"px")),widthDelta>0&&(iframe.css("margin-left",-Math.floor(widthDelta/2)+"px"),video.css("margin-left",-Math.floor(widthDelta/2)+"px"))}else{var video_height;height||(video_height=Math.floor(el.width()*video_ratio)),height&&height.indexOf("vh")>-1?video_height=Math.floor(window.innerHeight*(parseInt(height)/100)):height&&(video_height=parseInt(height)),iframe.css("width","100%"),iframe.height(video_height+"px")}}function processSrc(src,nocover,nomute){-1===src.indexOf("https://www.youtube.com/embed")&&(src="https://www.youtube.com/embed"+("/"===src[0]?src:"/"+src)),-1!==src.indexOf("?")?src+="&":src+="?";var extractVideoId=function(src){for(var parts=src.split("/"),neededPart=null,i=0,l=parts.length;i<l;i++)"embed"===parts[i]&&(neededPart=parts[i+1]);return-1!==neededPart.indexOf("?")&&(neededPart=neededPart.split("?")[0]),neededPart},currentLocation=location.protocol+"//"+location.host;return"yes"!=nocover?(src[src.length-1],src=src+"?autoplay=1&loop=1&enablejsapi=1&&playerapiid=featuredytplayer&controls=0&modestbranding=1&rel=0&showinfo=0&color=white&iv_load_policy=3&theme=light&wmode=transparent&origin="+currentLocation+"&playlist="+extractVideoId(src)):(src[src.length-1],src=src+"?autoplay=0&loop=0&enablejsapi=1&&playerapiid=featuredytplayer&controls=1&modestbranding=1&rel=0&showinfo=0&color=black&iv_load_policy=3&theme=dark&wmode=transparent&origin="+currentLocation),"yes"!==nomute&&(src+="&mute=1"),src}function onYouTubePlayerReady_do(div,player,nomute){var timer,wnd=$(window),frame=$(div),timer_count=0;wnd.scroll((function(){timer&&(window.clearTimeout(timer),timer_count>=15&&(timer_player_do(frame,wnd,player,nomute),timer_count=0),timer_count++),timer=window.setTimeout((function(){timer_player_do(frame,wnd,player,nomute),timer_count=0}),100)})),wnd.scroll()}function timer_player_do(frame,wnd,player,nomute){var a,b,c,d,s;a=frame.offset().top,b=frame.height(),c=wnd.scrollTop(),d=wnd.height(),s=player.getPlayerState(),c+d>a&&c<=a+b?(1!==s&&player.playVideo(),"yes"==nomute&&(c>a+b-100?player.setVolume(30):c>a+b-200?player.setVolume(70):c+d<a+200?player.setVolume(30):player.setVolume(100))):c+d<a&&c+d>a-500?2!==s&&(player.playVideo(),player.pauseVideo()):2!==s&&player.pauseVideo()}function load_youtube_api(){if("yes"!==window.loadytapi_flag){window.loadytapi_flag="yes";var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag)}}function setWidthHeightYoutubeVideo(el,height){console.log("setWidthHeightYoutubeVideo:"+height);var iframe=el.find("iframe"),nocover=el.attr("data-content-video-nocover"),noadcut=el.attr("data-content-video-noadcut-youtube"),customratio=el.attr("data-content-video-ratio"),video_ratio=.5625;if(customratio>0&&(video_ratio=1*parseFloat(customratio)),"yes"!=nocover){if(height||(height="100vh"),height.indexOf("vh")>-1){var wh=window.innerHeight;wh||(wh=$(window).height());var div_height=Math.floor(wh*(parseInt(height)/100))}else var div_height=parseInt(height);var div_width=Math.floor(parseInt(window.innerWidth));div_width||(div_width=$(window).width());var video_width=div_width,video_height,vw2=div_width,vh2=video_height=div_width*video_ratio,vh3=video_height,delta_coef=1;if("yes"!=noadcut&&(vh2=vh2+110+110,vh3=video_height-220),vh3<div_height)if(video_height<div_height)var delta_coef=div_height/video_height+.02;else var delta_coef=video_height/div_height+.02;var zoom_video_width=Math.floor(vw2*delta_coef),zoom_video_height=Math.floor(vh2*delta_coef),heightDelta=zoom_video_height-div_height,widthDelta=zoom_video_width-div_width;iframe.height(zoom_video_height+"px"),iframe.width(zoom_video_width+"px"),heightDelta>0&&iframe.css("margin-top",-Math.floor(heightDelta/2)+"px"),widthDelta>0&&iframe.css("margin-left",-Math.floor(widthDelta/2)+"px")}else{var video_height;height||(video_height=Math.floor(el.width()*video_ratio)),height&&height.indexOf("vh")>-1?video_height=Math.floor(window.innerHeight*(parseInt(height)/100)):height&&(video_height=parseInt(height)),iframe.css("width","100%"),iframe.height(video_height+"px")}}!function($){var def=$.Deferred();window.processYoutubeVideo=function(div,height){load_youtube_api();var defFunc=function(){var el=$(div),src=el.attr("data-content-video-url-youtube"),nomute=el.attr("data-content-video-nomute"),noloop=el.attr("data-content-video-noloop"),nocover=el.attr("data-content-video-nocover"),iframe=document.createElement("iframe"),playtimer;iframe.src=processSrc(src,nocover,nomute),iframe.frameBorder=0,iframe.allow="autoplay",div.appendChild(iframe),window.isMobile||new YT.Player(iframe,{events:{onReady:function(e){onYouTubePlayerReady_do(div,e.target,nomute),e.target.setVolume&&"yes"!=nomute&&e.target.setVolume(0),e.target.setLoop(!0)},onStateChange:function(e){if(e.target.setVolume&&"yes"!=nomute&&e.target.setVolume(0),-1===e.data){var sp=window.fix_scrolltop_beforestop_youtube;sp>=0&&($("html, body").scrollTop(sp),delete window.fix_scrolltop_beforestop_youtube)}e.data===YT.PlayerState.PLAYING?playtimer=window.setInterval((function(){var a=e.target.getCurrentTime(),b=e.target.getDuration();a+1>b&&0!==b&&(e.target.seekTo(0),"yes"===noloop&&(e.target.stopVideo(),e.target.clearVideo()))}),1e3):window.clearInterval(playtimer)}}}),setWidthHeightYoutubeVideo(el,height)};def.then(defFunc)},window.onYouTubeIframeAPIReady=function(){def.resolve()},$.fn.videoBG=function(selector,options){var options={};if("object"==typeof selector)options=$.extend({},$.fn.videoBG.defaults,selector);else{if(selector)return $(selector).videoBG(options);options=$.fn.videoBG.defaults}var container=$(this);if(container.length){"static"!=container.css("position")&&container.css("position")||container.css("position","relative"),0==options.width&&(options.width=container.width()),0==options.height&&(options.height=container.height()),options.textReplacement&&(options.scale=!0,container.width(options.width).height(options.height).css("text-indent","-9999px"));var video=$.fn.videoBG.video(options);return options.scale&&video.height(options.height).width(options.width),container.append(video),void 0===container.attr("data-content-video-nomute")&&container.find("video").prop("muted","true"),setWidthHeightHTMLVideo(video,options.height),video.find("video")[0]}},$.fn.videoBG.setFullscreen=function($el){var windowWidth=$(window).width(),windowHeight=$(window).height(),height,shift,width,shift;($el.css("min-height",0).css("min-width",0),$el.parent().width(windowWidth).height(windowHeight),windowWidth/windowHeight>$el.aspectRatio)?($el.width(windowWidth).height("auto"),(shift=($el.height()-windowHeight)/2)<0&&(shift=0),$el.css("top",-shift)):($el.width("auto").height(windowHeight),(shift=($el.width()-windowWidth)/2)<0&&(shift=0),$el.css("left",-shift),0===shift&&setTimeout((function(){$.fn.videoBG.setFullscreen($el)}),500));$("body > .videoBG_wrapper").width(windowWidth).height(windowHeight)},$.fn.videoBG.video=function(options){var $div=$("<div/>");$div.addClass("videoBG").css("position",options.position).css("z-index",options.zIndex).css("top",0).css("left",0).css("height",options.height).css("width",options.width).css("opacity",options.opacity).css("overflow","hidden");var $video=$("<video/>"),resizeTimeout;($video.css("position","relative").css("z-index",options.zIndex).attr("poster",options.poster).css("top",0).css("left",0).css("min-width","100%").css("min-height","100%"),$video.prop("autoplay",options.autoplay),$video.prop("loop",options.loop),$video.prop("muted",options.muted),options.volume>0?$video.prop("volume",options.volume):$video.prop("volume",0),options.fullscreen)&&($video.bind("canplay",(function(){$video.aspectRatio=$video.width()/$video.height(),$.fn.videoBG.setFullscreen($video)})),$(window).resize((function(){clearTimeout(resizeTimeout),resizeTimeout=setTimeout((function(){$.fn.videoBG.setFullscreen($video)}),100)})),$.fn.videoBG.setFullscreen($video));var v=$video[0];if(options.loop){var loops_left=options.loop;$video.bind("ended",(function(){loops_left&&v.play(),!0!==loops_left&&loops_left--}))}$video.bind("canplay",(function(){options.autoplay&&v.play()})),$.fn.videoBG.supportsVideo()&&($.fn.videoBG.supportType("webm")&&""!=options.webm?$video.attr("src",options.webm):$.fn.videoBG.supportType("mp4")&&""!=options.mp4?$video.attr("src",options.mp4):$video.attr("src",options.ogv));var $img=$("<img/>");return $img.attr("src",options.poster).css("position","absolute").css("z-index",options.zIndex).css("top",0).css("left",0).css("min-width","100%").css("min-height","100%"),$.fn.videoBG.supportsVideo()?$div.html($video):$div.html($img),options.textReplacement&&($div.css("min-height",1).css("min-width",1),$video.css("min-height",1).css("min-width",1),$img.css("min-height",1).css("min-width",1),$div.height(options.height).width(options.width),$video.height(options.height).width(options.width),$img.height(options.height).width(options.width)),$.fn.videoBG.supportsVideo(),$div},$.fn.videoBG.supportsVideo=function(){return document.createElement("video").canPlayType},$.fn.videoBG.supportType=function(str){if(!$.fn.videoBG.supportsVideo())return!1;var v=document.createElement("video");switch(str){case"webm":return v.canPlayType('video/webm; codecs="vp8, vorbis"');case"mp4":return v.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"');case"ogv":return v.canPlayType('video/ogg; codecs="theora, vorbis"')}return!1},$.fn.videoBG.wrapper=function(){var $wrap=$("<div/>");return $wrap.addClass("videoBG_wrapper").css("position","absolute").css("top",0).css("left",0),$wrap},$.fn.videoBG.defaults={mp4:"",ogv:"",webm:"",poster:"",autoplay:!0,loop:!0,scale:!1,position:"absolute",opacity:1,textReplacement:!1,zIndex:0,width:0,height:0,fullscreen:!1,imgFallback:!0}}(jQuery),function($){function VideoLoadProcessor(){this.setScrollListener()}VideoLoadProcessor.prototype.videoTags=[],VideoLoadProcessor.prototype.defaultConfig={isNeedStop:!1},VideoLoadProcessor.prototype.videoConfigs=[],VideoLoadProcessor.prototype.registerNewVideo=function(video,config){if(!(video instanceof HTMLVideoElement))throw new Error("Wrong tag passed into registerNewVideo");return-1==this.videoTags.indexOf(video)&&(this.videoTags.push(video),this.videoConfigs.push(void 0===config?this.defaultConfig:config),this.scrollCb("",!0),!0)},VideoLoadProcessor.prototype.unergisterVideo=function(video){if(!(video instanceof HTMLVideoElement))throw new Error("Wrong tag passed into unregisterNewVideo");var index;return(index=this.videoTags.indexOf(video))>-1&&("function"==typeof video.remove?video.remove():video.parentNode&&video.parentNode.removeChild(video),this.pauseVideo(video,this.videoConfigs[index]),this.videoTags.splice(index,1),this.videoConfigs.splice(index,1),!0)},VideoLoadProcessor.prototype.pauseVideo=function(video,config){if(!config)throw new Error("Wrong config type!");video.pause(),config.isNeedStop&&video.load()},VideoLoadProcessor.prototype.setScrollListener=function(){$(window).bind("scroll",t_throttle(jQuery.proxy(this.scrollCb,this),200))},VideoLoadProcessor.prototype.scrollCb=function(e,firstInvoke){for(var windowHeight=$(window).height(),_v=null,i=0,l=this.videoTags.length;i<l;i++){if(_v=this.videoTags[i],_vrect=this.getVideoBoundingRect(_v,!1),Math.abs(_vrect.top)<windowHeight&&Math.abs(_vrect.top)>windowHeight/2){var vol=1-(Math.abs(_vrect.top)-windowHeight/2)/(windowHeight/2)-.2;vol>0&&vol<=1&&0!=_v.volume&&(_v.volume=vol)}Math.abs(_vrect.top)>windowHeight||0==_vrect.height?this.pauseVideo(_v,this.videoConfigs[i]):(firstInvoke&&_v.play(),_v.paused&&_v.loop&&_v.play())}},VideoLoadProcessor.prototype.getVideoObject=function(video){for(var i=0,l=this.videoTags.length;i>l;i++){var vo=this.videoTags[i];if(vo.v===video)return vo}return null},VideoLoadProcessor.prototype.getVideoBoundingRect=function(video,isNeedParent){void 0===isNeedParent&&(isNeedParent=!0);var parent=null;return isNeedParent&&(parent=$(video).parents(".r")[0])||(parent=video),parent.getBoundingClientRect()},window.videoLoadProcessor=new VideoLoadProcessor}(jQuery);