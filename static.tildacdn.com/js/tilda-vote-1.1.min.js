function t_removeEl(e){e.parentNode&&e.parentNode.removeChild(e)}function tvote__init(e){var t;if(!document.getElementById("allrecords").getAttribute("data-tilda-mode")){var o=new Date,r,n=document.querySelector("#rec"+e).querySelector(".t-vote"),a=tvote__makeFullVoteID(n),i={type:n.getAttribute("data-vote-type"),voteID:a,voteEl:n,voteVisibility:n.getAttribute("data-vote-visibility"),startDate:o};t_vote__checkVoteCondition(i),"yes"!==n.getAttribute("data-vote-finished")?setTimeout((function(){t_vote__initOneVote(i)}),500):n.classList.add("t-vote_sended")}}function tvote__makeFullVoteID(e){e[0]&&(e=e[0]);var t=e.getAttribute("data-vote-id");if(t){var o=document.querySelector("#allrecords").getAttribute("data-tilda-project-id")+t;return o=o.replace("&quot;","").replace("&#039;","").replace(/[&/\\#,+()$~%.'":;*?!<>{}\-_\s]/g,""),e.setAttribute("data-vote-id",o),o}}function t_vote__checkVoteCondition(e){var t=t_vote__getCookie("vote"+e.voteID),o=t_vote__getCookie("voteresult"+e.voteID);if("yes"===e.voteVisibility||"onclick"===e.voteVisibility&&t){var r=e.voteEl.querySelectorAll(".t-vote__btn-res");Array.prototype.forEach.call(r,(function(e){e.style.display="block"}))}t&&(e.voteEl.classList.add("js-vote-sended"),e.voteEl.classList.add("t-vote_sended")),"single"===e.type&&t&&o&&e.voteEl.querySelector('[data-answer-id="'+o+'"] .t-vote__btn-el').classList.add("t-vote__btn-el_active"),tvote__getResult(e.voteID)}function t_vote__getCookie(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([.$?*|{}()[\]\\/+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function tvote__getResult(e){var t=document.querySelector('[data-vote-id="'+e+'"]'),o=t.getAttribute("data-vote-type");if("single"===o)var r="https://vote.tildacdn.com/vote/1/getresult/";if("multi"===o)var r="https://vote.tildacdn.com/vote/2/getresult/";if(o){var n=new XMLHttpRequest;r+="?voteid="+e+"&host="+location.protocol+"//"+location.host,n.open("GET",r,!0),n.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),n.onload=function(){if(n.status>=200&&n.status<400){var r=n.responseText;if(r){var a=JSON.parse(r);if("object"==typeof a)if(a.error){var i=t.querySelectorAll(".t-vote__btn-res");Array.prototype.forEach.call(i,(function(e){e.style.display="none"}))}else"single"===o&&Array.prototype.forEach.call(Object.keys(a[0]),(function(e){var o=t.querySelector('[data-answer-id="'+e+'"] .js-vote-count');o&&(o.innerHTML=a[0][e])})),"multi"===o&&(Array.prototype.forEach.call(Object.keys(a[0]),(function(e){var o=a[0][e],r=0;Array.prototype.forEach.call(Object.keys(o),(function(e){r+=1*o[e]})),Array.prototype.forEach.call(Object.keys(o),(function(n){var a=o[n],i=Math.round(100*a/r),s=n.slice(0,n.indexOf("-")),l=t.querySelector('[data-question-id="'+e+'"] [data-answer-id="'+s+'"]');if(l){var v=l.querySelector(".js-vote-count"),c=l.querySelector(".js-vote-percent");v&&(v.innerHTML=a),c&&(c.innerHTML=i+"%")}}))})),setTimeout((function(){var e;($(t).trigger("tildavote:numberschanged"),t)&&(/msie|trident/i.test(navigator.userAgent)?(e=document.createEvent("Event")).initEvent("tildavote:numberschanged",!0,!1):e=new Event("tildavote:numberschanged"),t.dispatchEvent(e))}),1e3));else t_vote__showError(e,"")}else t_vote__showError(e,"")}else t_vote__showError(e,"")},n.onerror=function(){console.log("Fatal error: "+n),t_vote__showError(e,"")},n.send()}}function t_vote__initOneVote(e){var t=e.voteEl.querySelectorAll(".js-sendvote-btn");Array.prototype.forEach.call(t,(function(t){t.addEventListener("click",(function(o){if(!e.voteEl.classList.contains("js-vote-sending")){var r=!0;"single"===e.type&&(e.answerID=t.closest(".js-vote-item").getAttribute("data-answer-id"),e.clickedEl=t,e.url="https://vote.tildacdn.com/vote/1/",r=t_vote__handleClick_single(e)),"multi"===e.type&&(e.url="https://vote.tildacdn.com/vote/2/",r=t_vote__handleClick_multi(e)),r&&(t_vote__itemSend(e),o.preventDefault())}}))}))}function t_vote__handleClick_single(e){return!(!e.clickedEl.classList.contains("t-vote__btn-el_active")&&e.voteEl.classList.contains("js-vote-sended"))&&(!e.clickedEl.classList.contains("t-vote__btn-el_active")||!e.voteEl.classList.contains("js-vote-sended")||(t_vote__getCookie("vote_candelete"+e.voteID)&&t_vote__itemDelete_single(e),!1))}function t_vote__handleClick_multi(e){var t=[],o=e.voteEl.querySelectorAll(".js-vote-question"),r=e.voteEl.querySelectorAll(".js-vote-question").length;return o=Array.prototype.filter.call(o,(function(e){if(e.querySelector(".js-vote-btn:checked"))return e})),!e.voteEl.classList.contains("js-vote-sended")&&(o.length!=r?("RU"===window.tildaBrowserLang?t_vote__showError(e.voteID,"Пожалуйста, ответьте на все вопросы."):t_vote__showError(e.voteID,"Please, answer all questions."),!1):(Array.prototype.forEach.call(o,(function(o){var r=o.getAttribute("data-question-id"),n=o.querySelectorAll(".js-vote-btn:checked"),a=[];Array.prototype.forEach.call(n,(function(t){var o=t.closest(".js-vote-item").getAttribute("data-answer-id");a.push(o+"-"+r+"-"+e.voteID)})),t.push({answer:a,question:r})})),e.answerArr=t,!0))}function t_vote__itemSend(e){if(e.seconds_fromStart=((new Date).getTime()-e.startDate.getTime())/1e3,t_vote__changeVoteCondition(e,"add"),e.voteEl.classList.add("js-vote-sending"),e.voteEl.classList.add("t-multivote_sended"),t_vote__addLoadingStyle(e.voteEl),"onclick"===e.voteVisibility){var t=e.voteEl.querySelectorAll(".t-vote__btn-res");Array.prototype.forEach.call(t,(function(e){e.style.display="block"}))}var o=new FormData,r=new XMLHttpRequest;o.append("host",location.protocol+"//"+location.host),r.open("POST",e.url+"init/",!0),r.onload=function(){if(r.status>=200&&r.status<400){var t=r.responseText;if(t){var o=JSON.parse(t);"object"==typeof o?(e.sessionKey=o.key,e.sessionCookie=o.session,e.voteHash=e.voteID+e.sessionKey,t_vote__itemSend_continue(e)):t_vote__showError(e.voteID,"")}else t_vote__showError(e.voteID,"")}else t_vote__showError(e.voteID,"")},r.onerror=function(){console.log("Fatal error: "+r),t_vote__changeVoteCondition(e,"remove"),t_vote__showError(e.voteID,"")},r.send(o)}function t_vote__itemSend_continue(e,t){var o=document.querySelector("#allrecords"),r=o.getAttribute("data-tilda-page-id"),n=o.getAttribute("data-tilda-project-id"),a={hash:e.voteHash,projectid:n,pageid:r,host:location.protocol+"//"+location.host,time:e.seconds_fromStart,session:e.sessionCookie};"single"===e.type&&(a.voteid=e.voteID,a.answerid=e.answerID),"multi"===e.type&&(a.multivoteid=e.voteID,a.answers=e.answerArr),t&&(a.votecaptcha=t,t_vote__changeVoteCondition(e,"add")),a=t_vote__getObjParams(a);var i=new FormData;Array.prototype.forEach.call(Object.keys(a),(function(e){i.append(e,a[e])}));var s=new XMLHttpRequest;s.open("POST",e.url+"send/",!0),s.onload=function(){if(s.status>=200&&s.status<400){var t=s.responseText;if(t){e.voteEl.classList.remove("js-vote-sending"),e.voteEl.classList.remove("t-vote_loading");var o=JSON.parse(t);if("object"==typeof o)if(o.error)t_vote__changeVoteCondition(e,"remove"),e.voteEl.classList.remove("t-vote_sended"),t_vote__handleServerError(o,e);else{e.voteEl.classList.add("js-vote-sended"),e.voteEl.classList.add("t-vote_sended"),t_vote__writeSendCookie(o,e);var r=e.voteEl.querySelector(".t-vote__errorbox"),n;if(r&&t_removeEl(r),$(e.voteEl).trigger("tildavote:resultsended"),e.voteEl)/msie|trident/i.test(navigator.userAgent)?(n=document.createEvent("Event")).initEvent("tildavote:resultsended",!0,!1):n=new Event("tildavote:resultsended"),e.voteEl.dispatchEvent(n)}else t_vote__showError(e.voteID,"")}else t_vote__showError(e.voteID,"")}else t_vote__showError(e.voteID,"")},s.onerror=function(){console.log("Fatal error: "+s),t_vote__showError(e.voteID,"")},s.send(i)}function t_vote__getObjParams(e,t){var o={},t=t||"";return Array.prototype.forEach.call(Object.keys(e),(function(r){var n;Array.isArray(e[r])?Array.prototype.forEach.call(e[r],(function(e,n){var a;e instanceof Object?(t=r+"["+n+"]",Object.assign(o,t_vote__getObjParams(e,t)),t=""):o[t+"["+r+"][]"]=e})):t?o[t+"["+r+"]"]=e[r]:o[r]=e[r]})),o}function t_vote__writeSendCookie(e,t){"ok"===e.message&&(t_vote__setCookie("vote"+e.voteid,t.voteHash,{expires:86400}),"single"===t.type&&(t_vote__setCookie("voteresult"+e.voteid,t.answerID,{expires:86400}),t_vote__setCookie("vote_candelete"+e.voteid,"yes",{expires:1800})))}function t_vote__itemDelete_single(e){e.seconds_fromStart=((new Date).getTime()-e.startDate.getTime())/1e3,t_vote__changeVoteCondition(e,"remove"),e.voteEl.classList.add("js-vote-sending"),e.voteEl.classList.remove("t-vote_sended"),t_vote__addLoadingStyle(e.voteEl),e.voteHash=t_vote__getCookie("vote"+e.voteID);var t={voteid:e.voteID,hash:e.voteHash,host:location.protocol+"//"+location.host},o=new FormData;Array.prototype.forEach.call(Object.keys(t),(function(e){o.append(e,t[e])}));var r=new XMLHttpRequest;r.open("POST",e.url+"delete/",!0),r.onload=function(){if(r.status>=200&&r.status<400){var t=r.responseText;if(t){e.voteEl.classList.remove("js-vote-sending"),e.voteEl.classList.remove("t-vote_loading");var o=JSON.parse(t);"object"==typeof o?o.error?(t_vote__changeVoteCondition(e,"add"),e.voteEl.classList.add("t-vote_sended"),t_vote__handleServerError(o,e)):(e.voteEl.classList.remove("js-vote-sended"),e.voteEl.classList.remove("t-vote_sended"),t_vote__removeSendCookie(o,e)):t_vote__showError(e.voteID,"")}else t_vote__showError(e.voteID,"")}else t_vote__showError(e.voteID,"")},r.onerror=function(){console.log("Fatal error: "+r),t_vote__showError(e.voteID,"")},r.send(o)}function t_vote__removeSendCookie(e,t){if("ok"===e.message){var o={expires:1};t_vote__setCookie("vote"+e.voteid,t.voteHash,o),t_vote__setCookie("voteresult"+e.voteid,"",o),t_vote__setCookie("vote_candelete"+e.voteid,"",o)}}function t_vote__addLoadingStyle(e){setTimeout((function(){e.classList.contains("js-vote-sending")&&e.classList.add("t-vote_loading")}),150)}function t_vote__handleServerError(e,t){if(6==e.error)return window.tvote_opts=t,void addTildaCaptcha();var o="";o="RU"===window.tildaBrowserLang?"Что-то пошло не так и голосование не может корректно работать. Пожалуйста, попробуйте другой браузер, отключите режим инкогнито или обратитесь к владельцу сайта.":"Something went wrong and vote doesn't work correctly. Please, try another browser, unlock private mode or write to website owner.",1==e.error&&(o="RU"===window.tildaBrowserLang?"С этого IP недавно голосовали. Пожалуйста, подождите 10 минут и попробуйте еще раз.":"Somebody has recently voted from this IP. Please wait 10 minutes and try again."),2==e.error&&(o="RU"===window.tildaBrowserLang?"С вашего IP адреса приходит слишком много запросов к серверу. Сервер временно не может принимать голоса с этого IP. Пожалуйста, попробуйте еще раз позже.":"There are too many votes from your IP. Server temporarily can't get votes from this IP. Please, try again later."),4==e.error&&(o="RU"===window.tildaBrowserLang?"Извините, но голос удалить уже нельзя. Удалить голос можно только в течение 30 минут после активации.":"Sorry, but you can't delete vote now. You can delete votes just during 30 minutes after activation."),5==e.error&&(o="RU"===window.tildaBrowserLang?"С вашего IP запросы приходят слишком часто. Пожалуйста, подождите 7 секунд прежде чем выбирать ответы в слудующих голосованиях на странице.":"Votes are sended too often from your IP. Please wait 7 seconds between choosing answers in different votes."),t_vote__showError(t.voteID,o)}function addTildaCaptcha(){var e=document.querySelector("#tildavotecaptchabox");e&&t_removeEl(e),document.body.insertAdjacentHTML("beforebegin",'<div id="tildavotecaptchabox" style="z-index: 100000;position:fixed; text-align: center; vertical-align: middle; top: 0px; left:0px; bottom: 0px; right: 0px; background: rgba(255,255,255,0.97);"><iframe id="captchaIframeBox" src="https://vote.tildacdn.com/vote/1/send/showcaptcha.php" frameborder="0" width="100%" height="100%"></iframe></div>'),window.removeEventListener("message",checkVerifyTildaVoteCaptcha),window.addEventListener("message",checkVerifyTildaVoteCaptcha)}function checkVerifyTildaVoteCaptcha(e){var t=document.querySelector("#tildavotecaptchabox");if(-1!==e.origin.indexOf("vote.tildacdn.com")){if(t&&t_removeEl(t),"closeiframe"===e.data)return;t_vote__itemSend_continue(window.tvote_opts,e.data)}}function t_vote__showError(e,t){t||(t="RU"===window.tildaBrowserLang?"Что-то пошло не так и голосование может работать некорректно. Пожалуйста, проверьте соединение с интернетом или обратитесь к владельцу сайта.":"Something went wrong and vote doesn't work correctly. Please, check your internet connection or write to website owner.");var o=document.querySelector('[data-vote-id="'+e+'"]'),r=o.getAttribute("data-vote-type");if(!r||"single"===r){var n="<div class='t-vote__errorbox'><div class='t-vote__errorbox-text t-text t-text_xs t-align_center' style='background-color:#333;color:#fff;padding:20px;margin-top:30px;'>"+t+"</div></div>";o.insertAdjacentHTML("afterend",n),o.style.display="none"}if("multi"===r){var a=o.querySelector(".t-vote__errorbox");a&&t_removeEl(a);var n="<div class='t-vote__errorbox'><div class='t-vote__errorbox-text t-text t-text_xs t-align_center' style='background-color:#F95D51;color:#fff;padding:20px;margin:30px 0px;'>"+t+"</div></div>",i=o.querySelectorAll(".js-sendvote-btn");i[i.length-1].insertAdjacentHTML("beforebegin",n)}}function t_vote__changeVoteCondition(e,t){var o,o;("multi"===e.type&&t_vote__changeStat(e,t),"single"===e.type&&"add"===t)&&(t_vote__incrementAnswerNum(e.voteID,e.answerID),(o=e.voteEl.querySelector('[data-answer-id="'+e.answerID+'"] .t-vote__btn-el')).classList.add("t-vote__btn-el_active"));"single"===e.type&&"remove"===t&&(t_vote__decrementAnswerNum(e.voteID,e.answerID),(o=e.voteEl.querySelector(".t-vote__btn-el_active")).classList.remove("t-vote__btn-el_active"))}function t_vote__changeStat(e,t){var o=e.voteEl.querySelectorAll(".js-vote-question"),r;(Array.prototype.forEach.call(o,(function(e){var o=e.querySelectorAll(".js-vote-item"),r=0;Array.prototype.forEach.call(o,(function(e){var o=e.querySelector(".js-vote-count");if(o){var n=1*o.textContent,a=e.querySelectorAll(".js-vote-btn:checked").length;r+=n,0!==a&&"add"===t&&(r++,n++,o.innerHTML=n),0!==a&&"remove"===t&&(r--,n--,o.innerHTML=n)}})),Array.prototype.forEach.call(o,(function(e){var t=e.querySelector(".js-vote-count"),o=e.querySelector(".js-vote-percent"),n=0;t&&(n=1*t.textContent);var a=Math.round(100*n/r);0!==r?(t&&(t.innerHTML=n),o&&(o.innerHTML=a+"%")):(t&&(t.innerHTML=0),o&&(o.innerHTML="0%"))}))})),$(e.voteEl).trigger("tildavote:numberschanged"),e.voteEl)&&(/msie|trident/i.test(navigator.userAgent)?(r=document.createEvent("Event")).initEvent("tildavote:numberschanged",!0,!1):r=new Event("tildavote:numberschanged"),e.voteEl.dispatchEvent(r))}function t_vote__incrementAnswerNum(e,t){var o=document.querySelector('[data-vote-id="'+e+'"] [data-answer-id="'+t+'"] .js-vote-count'),r=o.textContent;o.innerHTML=1*++r}function t_vote__decrementAnswerNum(e,t){var o=document.querySelector('[data-vote-id="'+e+'"] [data-answer-id="'+t+'"] .js-vote-count'),r=o.textContent;o.innerHTML=1*--r}function t_vote__setCookie(e,t,o){var r=(o=o||{}).expires;if("number"==typeof r&&r){var n=new Date;n.setTime(n.getTime()+1e3*r),r=o.expires=n}r&&r.toUTCString&&(o.expires=r.toUTCString());var a=e+"="+(t=encodeURIComponent(t));for(var i in o){a+="; "+i;var s=o[i];!0!==s&&(a+="="+s)}document.cookie=a+"; SameSite=Lax;"}Array.prototype.some||(Array.prototype.some=function(e){"use strict";if(null==this)throw new TypeError("Array.prototype.some called on null or undefined");if("function"!=typeof e)throw new TypeError;for(var t=Object(this),o=t.length>>>0,r=arguments.length>=2?arguments[1]:void 0,n=0;n<o;n++)if(n in t&&e.call(r,t[n],n,t))return!0;return!1}),function(e){var t=e.matches||e.matchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector;e.matches=e.matchesSelector=t||function e(t){var e=document.querySelectorAll(t),o=this;return Array.prototype.some.call(e,(function(e){return e===o}))}}(Element.prototype),Element.prototype.closest||(Element.prototype.closest=function(e){for(var t=this;t&&1===t.nodeType;){if(Element.prototype.matches.call(t,e))return t;t=t.parentElement||t.parentNode}return null});